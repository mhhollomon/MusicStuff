
<!--- CONTROLS -->

<!-- Mode Selection -->
<div class="ma2">
    <div class="flex">
    <label class="mr2">Mode:</label>
    <select class="br2" [(ngModel)]="mode" (change)="mode_change()" >
        <option>Diatonic</option>
        <option>Chromatic</option>
    </select>
    </div>
</div>    

<!-- General Parameters -->
<div class="ma2">
    <div class="flex-wrap">

        <!-- Chord Count -->
        <div class="dif">
            <label class="mr2">Chord Count:</label>
            <input class="br2 mr3" matInput type="number" max="6" min="1" [(ngModel)]="chord_count" >
        </div>
        <!-- Duplicates -->
        <div class="dif mt1-ns mt2">
            <label class="mr2">Duplicates:</label>
            <select class="br2 mr3" [(ngModel)]="duplicates" >
                <option>None</option>
                <option>Not Adjacent</option>
                <option>Any</option>
            </select>
        </div>
    </div>
</div>

<!-- Chord Tones -->
<mat-checkbox class="br2" [(ngModel)]="show_chord_tones" >Show Chord Tones</mat-checkbox>

<!-- Chord Selection -->
<div class="ma2" >
    <mat-label class="mr2">Chord Types</mat-label>
    <mat-checkbox [(ngModel)]="allow_triads">Triads</mat-checkbox>
    <mat-checkbox [(ngModel)]="allow_sevenths">7ths</mat-checkbox>
</div> 

<!-- Key Selection  (Diatonic only) -->
<div class="ma2" *ngIf="!scale_disabled">
    <mat-label>Key</mat-label>
    <mat-radio-group [(ngModel)]="scale_source">
        <mat-radio-button value="Random">Random</mat-radio-button>
        <mat-radio-button value="Selected">Selected</mat-radio-button>
    </mat-radio-group>
    <div class="mt2 mh4" *ngIf="scale_source == 'Selected'">

        <!-- Sonority -->
        <select class="br2 mr2" [(ngModel)]="selected_sonority">
            <option>major</option>
            <option>minor</option>
        </select>

        <!-- Key Center -->
        <select class="br2 mr3" [(ngModel)]="selected_key">
            <option>Random</option>
            <option *ngFor="let k of (selected_sonority==='minor' ? minorkeys : majorkeys)">{{k}}</option>
        </select>
    </div>
</div> 

<!-- Generate Button -->
<div class="db mv4 br2 ma2">
    <button  mat-stroked-button color="primary" (click)="generate()">Generate Chords</button>
</div>

<!-- OUTPUT -->
<div class="ba bw1 br3 ph2 min-h-2">
    <!-- Key Information -->
    <mat-expansion-panel hideToggle [disabled]="!show_chords" *ngIf="show_key">
        <mat-expansion-panel-header>
          <mat-panel-title>
            Key = <span class="ml1" *ngIf="show_chords">{{key.fullDisplay()}}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <span class="mh2" *ngFor="let n of scale_notes">{{n.noteDisplay()}}</span>
    </mat-expansion-panel>

    <!-- Chord Information -->
    <div class="chord-container ml3 pb3">
        <ng-template ngFor let-c [ngForOf]="chords">
            <div class="chord-name mv2"><button class="dif" (click)="play_chord(c)" mat-mini-fab>>></button><span class="dif">{{c.name}}</span></div>
            <div class="chord-tones mv2" *ngIf="show_chord_tones">
                <span class="mh2" *ngFor="let t of c.chordTones" >{{t.noteDisplay()}}</span>
            </div>
        </ng-template>
    </div>
</div>

<!-- FOOTNOTES -->
<ul class="mv4 i f6 indent-small">
    <li>Two chords are consider duplicate if the root notes are the same - inversion and quality are not consulted.</li>
    <li>Only triads and 7ths (for now)</li>
    <li>3rd Inversion 7ths are never generated.</li>
    <li>In <span class="b">Chromatic</span> mode
        <ul class="indent-small">
            <li>Dominant 7ths are never generated</li>    
            <li>The chord qualities are weighted in the ratio they appear in a major scale.</li>  
        </ul>
    </li>  
</ul>
